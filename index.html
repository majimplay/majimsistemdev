<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Frete</title>
    <style>
        /* Estilos mantidos do anterior */
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        .container { background: #f5f5f5; padding: 20px; border-radius: 8px; }
        input, button { padding: 10px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #4CAF50; color: white; cursor: pointer; }
        button:hover { background: #45a049; }
        .error { color: red; display: none; }
        .result { margin-top: 20px; padding: 15px; background: white; border-radius: 4px; }
        .loader { /* manter anima√ß√£o igual */ }
    </style>
</head>
<body>
    <div class="container">
        <h1>Calculadora de Frete</h1>
        <input type="text" id="cep" placeholder="Digite o CEP (ex: 01001000)" maxlength="9">
        <button onclick="calcularFrete()">Calcular</button>
        <div id="cepError" class="error"></div>
        <div class="loader" id="loader"></div>
        <div id="result" class="result"></div>
    </div>

    <script>
        // Configura√ß√µes (SUBSTITUIR COM SEUS DADOS)
        const CONFIG = {
            APP_ID: 'TYP8SUA8qxmHIRs1mHbiFalgRxCEf51sOiSWmNEY',
            JS_KEY: 'n4Gfko9sO7jiAUnWX5U5GGCDQ5QtPWX97K4TzB8I',
            ENDPOINT: 'https://parseapi.back4app.com/functions/calcularFrete'
        };

    async function calcularFrete() {
    const cep = document.getElementById('cep').value.replace(/\D/g, '');
    const errorDiv = document.getElementById('cepError');
    const loader = document.getElementById('loader');
    const resultDiv = document.getElementById('result');

    errorDiv.style.display = 'none';
    loader.style.display = 'block';
    resultDiv.innerHTML = '';

    try {
        // üî• CORRE√á√ÉO PRINCIPAL AQUI
        const response = await fetch(CONFIG.ENDPOINT, {
            method: 'POST', // M√©todo obrigat√≥rio
            headers: {
                'X-Parse-Application-Id': CONFIG.APP_ID,
                'X-Parse-JavaScript-Key': CONFIG.JS_KEY,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                cepDestino: cep // Garantir que est√° enviando string
            })
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || 'Erro desconhecido');
        }

        const result = await response.json();
        exibirResultados(result.data);

    } catch (error) {
        errorDiv.textContent = error.message;
        errorDiv.style.display = 'block';
    } finally {
        loader.style.display = 'none';
    }
}
        function exibirResultados(servicos) {
            let html = '<h3>Op√ß√µes de Frete:</h3>';
            
            if (!servicos || servicos.length === 0) {
                html = '<p>Nenhuma op√ß√£o dispon√≠vel para este CEP</p>';
            } else {
                servicos.forEach(servico => {
                    html += `
                        <div class="servico">
                            <strong>${servico.empresa}</strong><br>
                            <span>${servico.metodo}</span><br>
                            Prazo: ${servico.prazo} dias<br>
                            Pre√ßo: R$ ${servico.preco.toFixed(2).replace('.', ',')}
                        </div>
                        <hr>
                    `;
                });
            }

            document.getElementById('result').innerHTML = html;
        }
    </script>
</body>
</html>
